<div *ngIf="paquete" style="max-width: 800px; margin: 2rem auto; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); background-color: #fff; font-family: 'Segoe UI', sans-serif;">
  <h2 style="font-size: 2rem; margin-bottom: 1rem; color: #333;">{{ paquete.titulo }}</h2>

  <img [src]="paquete.imagenUrl"
       [alt]="paquete.titulo"
       style="width: 100%; max-height: 400px; object-fit: cover; border-radius: 8px; margin-bottom: 1.5rem;" />

  <div style="margin-bottom: 1.5rem;">
    <p><strong>ğŸ“ Localidad:</strong> {{ paquete.localidad }}</p>
    <p><strong>ğŸ“ DescripciÃ³n:</strong> {{ paquete.descripcion }}</p>
    <p><strong>ğŸ’° Precio total:</strong> S/. {{ paquete.precioTotal | number:'1.2-2' }}</p>
    <p><strong>â³ DuraciÃ³n:</strong> {{ paquete.duracionDias }} dÃ­as</p>
    <p><strong>ğŸ‘¥ Cupos mÃ¡ximos:</strong> {{ paquete.cuposMaximos }}</p>
    <p><strong>ğŸ¯ Tipo de actividad:</strong> {{ paquete.tipoActividad }}</p>
    <p><strong>ğŸ“¦ Estado:</strong>
      <span [style.color]="paquete.estado === 'DISPONIBLE' ? '#28a745' : '#dc3545'">
        {{ paquete.estado }}
      </span>
    </p>
  </div>

  <div style="margin-bottom: 1.5rem;" *ngIf="paquete.proveedor">
    <h3 style="font-size: 1.25rem; margin-bottom: 0.5rem; color: #555;">Proveedor</h3>
    <p><strong>ğŸ‘¤ Nombre:</strong> {{ paquete.proveedor.nombreCompleto }}</p>
    <p><strong>ğŸ“§ Email:</strong> {{ paquete.proveedor.email }}</p>
    <p><strong>ğŸ“ TelÃ©fono:</strong> {{ paquete.proveedor.telefono }}</p>
  </div>

  <div style="margin-bottom: 2rem;" *ngIf="paquete.destino">
    <h3 style="font-size: 1.25rem; margin-bottom: 0.5rem; color: #555;">Destino</h3>
    <p><strong>ğŸ—ºï¸ Nombre:</strong> {{ paquete.destino.nombre }}</p>
    <p><strong>ğŸ“„ DescripciÃ³n:</strong> {{ paquete.destino.descripcion }}</p>
    <p><strong>ğŸ“ UbicaciÃ³n:</strong> {{ paquete.destino.ubicacion }}</p>
  </div>

  <!-- SecciÃ³n de botones -->
  <div *ngIf="isAuthenticated && paquete.estado === 'DISPONIBLE'" style="margin-top: 2rem; display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
    <label for="cantidadInput">ğŸ‘¥ Cantidad de personas:</label>
    <input
      id="cantidadInput"
      type="number"
      [(ngModel)]="cantidadCarrito"
      min="1"
      [max]="paquete.cuposMaximos"
      style="width: 70px;"
    />

    <button (click)="agregarAlCarrito()" class="btn btn-primary">
      ğŸ›’ Agregar al Carrito
    </button>

    <button (click)="manejarReserva()" class="btn btn-success">
      ğŸ“ Reservar
    </button>
  </div>

  <!-- COMPONENTE DE RESERVA - SOLO UNA VEZ CON TODOS LOS EVENTOS -->

  <!-- Si el usuario NO estÃ¡ autenticado -->
  <div *ngIf="!isAuthenticated" style="padding: 1rem; background-color: #f8f9fa; border-radius: 8px; border: 1px solid #dee2e6;">
    <p style="margin-bottom: 1rem; color: #6c757d;">
      ğŸ’¡ Para realizar una reserva, necesitas iniciar sesiÃ³n o registrarte
    </p>

    <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
      <button (click)="manejarReserva()" class="btn btn-primary">ğŸ” Iniciar SesiÃ³n</button>
      <button (click)="irAlRegistro()" class="btn btn-success">ğŸ“ Registrarse</button>
    </div>
  </div>

  <!-- Componente de formulario de reserva -->

  <app-crearreserva
    *ngIf="mostrarFormulario && isAuthenticated"
    [paqueteId]="paquete.id ?? paquete.idPaquete"
    (reservaExitosa)="onReservaExitosa()"
    (volverAlPaquete)="onVolverAlPaquete()">
  </app-crearreserva>

  <!-- Info adicional -->
  <div style="margin-top: 1.5rem; padding: 1rem; background-color: #e3f2fd; border-radius: 8px; border-left: 4px solid #2196f3;">
    <h4 style="margin: 0 0 0.5rem 0; color: #1976d2;">â„¹ï¸ InformaciÃ³n importante</h4>
    <ul style="margin: 0; padding-left: 1.2rem; color: #555;">
      <li>El precio incluye todos los servicios mencionados</li>
      <li>Las reservas estÃ¡n sujetas a disponibilidad</li>
      <li>Se requiere confirmaciÃ³n para procesar la reserva</li>
      <li *ngIf="paquete.cuposMaximos">Cupos limitados: mÃ¡ximo {{ paquete.cuposMaximos }} personas</li>
    </ul>
  </div>
</div>

<!-- Loading -->
<div *ngIf="!paquete" style="text-align: center; padding: 2rem;">
  <p>Cargando informaciÃ³n del paquete...</p>
</div>
